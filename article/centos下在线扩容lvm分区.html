<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>centos下在线扩容lvm分区</title>
    <link rel="icon" href="../static/img/favicon.png" type="image/png">
    <link rel="stylesheet" href="static/css/styles.css"> <!-- 静态文件的链接 -->
    <!-- 引入 highlight.js 的 CSS 样式 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/atom-one-dark.min.css">

</head>
<body>
    <header>
        <div class="navbar container">
            <div class="menu">
                <div class="nav-title"><a href="/index.html">各自花开</a></div>
                <ul class="nav-menu">
                    
                        <li><a href="/index.html">首页</a></li>
                        <li><a href="/categories.html">分类</a>
                        <li><a href="/tags.html">标签</a>






                        <li><a href="webnav.html">网址导航</a></li>
                        <li><a href="https://www.baidu.com" target="_blank">资源分享
                        <!-- 外部链接图标 -->
                        <img src="../static/img/分享_share.png" alt="外部链接" style="position: absolute; top: 0; right: 0; width: 12px; height: 12px;transform: translateX(100%)">
                        </a></li>
                        <li><a href="/search.html">搜索</a></li>
                    
                </ul>
            </div>
        </div>
    </header>
    <div id="app" class="container">

            
            


        <div class="main container">
                
    <div class="content article-content">
        <h3>centos下在线扩容lvm分区</h3>
        <div class="tag-container">
        








            
                <span>
                <img src="../static/img/标签_tag-one.png" class="img-icon">
                <a>linux</a>
            </span>
            

        </div>
        
        <div class="container article">
            <h2>lvm磁盘扩容大致步骤</h2>
<ul>
<li>查看并确认分区和新磁盘信息</li>
<li>对新磁盘进行分区</li>
<li>创建物理卷(pvdisplay查看物理卷)并将其加入需要扩容的卷组，也称逻辑卷(vgdisplay查看卷组名)</li>
<li>卷组扩容</li>
<li>调整分区大小</li>
</ul>
<h2>查看现有磁盘分区信息和新增磁盘信息</h2>
<pre class="codehilite"><code class="language-bash">df -h
fdisk -l
</code></pre>

<h2>对新磁盘进行分区</h2>
<pre class="codehilite"><code class="language-bash">fdisk /dev/sdb
n
p
1


t   
8e  #lvm格式
w   #退出保存

#格式化磁盘,具体根据磁盘分区格式决定。这里以ext4格式为例
mkfs.ext4 /dev/sdb1
</code></pre>

<h2>将物理卷加入卷组</h2>
<p>将刚刚创建的新的磁盘分区创建为物理卷</p>
<pre class="codehilite"><code class="language-bash">pvcreate /dev/sdb1
</code></pre>

<h2>查看物理卷信息</h2>
<pre class="codehilite"><code class="language-bash">pvdisplay
</code></pre>

<h2>查看当前系统卷组信息，确定物理卷需要加入的卷组名</h2>
<pre class="codehilite"><code class="language-bash">vgdisplay
</code></pre>

<h2>将pv加入vg</h2>
<ul>
<li>加入现有的lvm分区vg当中</li>
</ul>
<pre class="codehilite"><code class="language-bash">#假设`vgdisplay`显示的VGName名为centos
vgextend centos /dev/sdb1
</code></pre>

<ul>
<li>创建新的vg</li>
</ul>
<pre class="codehilite"><code class="language-bash">vgcreate lvm_data /dev/sdb1
</code></pre>

<h2>卷组扩容</h2>
<ul>
<li>现有的lvm扩容</li>
</ul>
<pre class="codehilite"><code class="language-bash">lvextend -l +100%FREE /dev/mapper/centos-root
</code></pre>

<ul>
<li>新创建vg创建逻辑卷</li>
</ul>
<pre class="codehilite"><code class="language-bash">lvcreate -l +100%FREE -n lvmdata_1 lvm_data
mkfs.ext4 /dev/mapper/lvm_data-lvmdata_1
</code></pre>

<h2>查看磁盘格式并调整分区大小</h2>
<p>改步骤对扩容lvm方式执行，对于新建lvm分区的忽略这一步</p>
<pre class="codehilite"><code class="language-bash">blkid

#ext4格式的话执行
 resize2fs /dev/mapper/centos-root
#xfs格式的话执行
xfs_growfs /dev/mapper/centos-root
</code></pre>

<h2>查看扩容后分区容量是否改变</h2>
<pre class="codehilite"><code class="language-bash">df -h
</code></pre>

<h2>删除物理卷，逻辑卷</h2>
<pre class="codehilite"><code class="language-bash">## 将已加入的物理卷移除卷组
vgreduce centos /dev/sdb1

#卷组缩减
lvreduce -L 10G /dev/mapper/centos-root

#分区缩小
resize2fs /dev/mapper/centos-root 10G

## 移除卷组上的PE,通过pvdisplay可以查看具体使用信息
pvmove /dev/sdb1
</code></pre>
        </div>
        
    </div>



                


        </div>

    </div>
    <footer>
        
        <p>&copy; 2024 | 我的博客. 保留所有权利。</p>
    <!--    <p><a href="/privacy">隐私政策</a> | <a href="/terms">使用条款</a></p>-->
        
    </footer>

</body>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
 <!-- 在页面加载完成后启用代码高亮 -->
    <script>
        // 等待页面加载完成后执行高亮
        document.addEventListener('DOMContentLoaded', function() {
            // 启用 highlight.js 代码高亮
            hljs.highlightAll();
        });
    </script>


</html>