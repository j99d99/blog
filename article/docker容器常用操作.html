<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>docker容器常用操作</title>
    <link rel="icon" href="../static/img/favicon.png" type="image/png">
    <link rel="stylesheet" href="static/css/styles.css"> <!-- 静态文件的链接 -->
    <!-- 引入 highlight.js 的 CSS 样式 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/atom-one-dark.min.css">

</head>
<body>
    <header>
        <div class="navbar container">
            <div class="menu">
                <div class="nav-title"><a href="/index.html">各自花开</a></div>
                <ul class="nav-menu">
                    
                        <li><a href="/index.html">首页</a></li>
                        <li><a href="/categories.html">分类</a>
                        <li><a href="/tags.html">标签</a>






                        <li><a href="webnav.html">网址导航</a></li>
                        <li><a href="https://www.baidu.com" target="_blank">资源分享
                        <!-- 外部链接图标 -->
                        <img src="../static/img/分享_share.png" alt="外部链接" style="position: absolute; top: 0; right: 0; width: 12px; height: 12px;transform: translateX(100%)">
                        </a></li>
                        <li><a href="/search.html">搜索</a></li>
                    
                </ul>
            </div>
        </div>
    </header>
    <div id="app" class="container">

            
            


        <div class="main container">
                
    <div class="content article-content">
        <h3>docker容器常用操作</h3>
        <div class="tag-container">
        








            
                <span>
                <img src="../static/img/标签_tag-one.png" class="img-icon">
                <a>docker</a>
            </span>
            

        </div>
        
        <div class="container article">
            <h4>docker容器操作常用命令</h4>
<h4>创建并启动一个容器</h4>
<p>启动容器有两种方式，一种是以交互式启动，即启动后就直接进入到容器内部进行交互操作，还有一种就是以守护进程(后台运行)启动。</p>
<!--more-->
<p>创建容器命令
docker run [OPTIONS] 镜像名:标签名 命令</p>
<p>[OPTIONS]常用参数说明</p>
<ul>
<li>-i 交互式运行容器(创建后马上启动容器并进入容器),通常与-t同时使用</li>
<li>-t 启动后会进入容器命令行,通常与-i同时使用</li>
<li>--name 为创建的容器指定一个名称</li>
<li>-d 创建一个守护式容器在后台运行并返回容器ID</li>
<li>-v 表示目录映射,格式为：-v 宿主机目录:容器目录</li>
<li>-p 表示端口映射,格式为: -p 宿主机端口:容器端口</li>
</ul>
<p>容器需要一个保持前台运行的进程。可以在启动容器的时候指定前台运行的命令，不指定则默认运行镜像内的命令</p>
<p><strong>创建交互式容器</strong></p>
<pre class="codehilite"><code class="language-bash">docker run -it --name=dockertest centos:7 /bin/bash
</code></pre>

<p><strong>特殊使用</strong>,交互式启动时加上--rm参数后，容器运行一次就结束并删除容器。通常用来测试某条命令在容器内执行结果时使用</p>
<pre class="codehilite"><code>docker run -it  --rm --name=dockertest centos:7 ip addr
</code></pre>

<h5><strong>创建守护式容器</strong></h5>
<p>守护式容器,俗称后台运行的容器，通常加上--restart=always参数，如果容器退出了会自动重启</p>
<pre class="codehilite"><code>docker  run -d --name=mycentos --restart=always centos:7
</code></pre>

<h5></h5>
<h4>宿主机与容器文件拷贝</h4>
<p>通过docker cp 命令可以将宿主机文件拷贝到容器内,也可以将容器内文件拷贝到宿主机</p>
<ul>
<li>宿主机拷贝到容器</li>
</ul>
<pre class="codehilite"><code>docker cp 宿主机文件或目录 容器名称:容器文件或目录
</code></pre>

<ul>
<li>容器文件拷贝到宿主机</li>
</ul>
<pre class="codehilite"><code>docker cp 容器名称:容器文件或目录 宿主机文件或目录
</code></pre>

<h4>数据目录挂载</h4>
<p>在创建容器的时候,将宿主机目录与容器目录进行映射,这样就可以 通过修改宿主机某个目录的文件从而去影响容器,挂载目录使用-v参数</p>
<pre class="codehilite"><code>docker run -d -v 宿主机绝对路径目录：容器内目录 --name=容器名 镜像名
</code></pre>

<p>例:
创建容器时将宿主机目录/opt 挂载到容器目录/opt</p>
<pre class="codehilite"><code>docker run -d -v /opt:/opt --name=mycentos centos:7
</code></pre>

<p>目录挂载只读权限</p>
<pre class="codehilite"><code>docker run -d -v 宿主机绝对路径目录:容器内目录:ro --name=容器名 镜像名
</code></pre>

<h4>端口映射</h4>
<p>在创建容器的时候，经常需要将容器内部的应用端口暴露出来供外部访问。通常使用-p参数来映射端口,如果有多个端口需要映射，就多次使用-p参数即可。如果宿主机映射端口不指定的话，将随机映射一个端口</p>
<pre class="codehilite"><code class="language-bash">#基本语法:
docker run -d -p 宿主机IP:宿主机端口:容器端口/协议类型(tcp/udp)
</code></pre>

<p>几个举例</p>
<pre class="codehilite"><code class="language-bash">#将容器的22端口映射到本机的2222端口
docker run -d -p 2222:22 --name=mycentos centos:7
#映射端口时也可以绑定本机IP，将容器22端口映射到本机2222端口并绑定127.0.0.1
docker run -d -p 127.0.0.1:2222:22 --name=mycentos centos:7
#映射时指定端口协议
docker run -d -p 2222:22/tcp --name=mycentos centos:7
#随机映射端口
docker run -d -p 127.0.0.1::22 --name=mycentos centos:7
</code></pre>

<p>查看容器映射了哪些端口</p>
<pre class="codehilite"><code class="language-bash">#查看上述举例的映射端口
docker port mycentos 
</code></pre>

<h4>启动与停止已存在的容器</h4>
<ul>
<li>启动容器</li>
</ul>
<pre class="codehilite"><code>docker start 容器名称|容器ID
</code></pre>

<ul>
<li>启动所有容器</li>
</ul>
<pre class="codehilite"><code>docker start `docker ps -a -q`
</code></pre>

<ul>
<li>正常停止正在运行的docker容器</li>
</ul>
<pre class="codehilite"><code>docker stop 容器名称|容器ID
</code></pre>

<ul>
<li>强行停止正在运行的容器</li>
</ul>
<pre class="codehilite"><code>docker  kill 容器名称|容器ID
</code></pre>

<ul>
<li>停止所有在运行的容器</li>
</ul>
<pre class="codehilite"><code>docker stop `docker ps -a -q`
</code></pre>

<h4>查看容器</h4>
<pre class="codehilite"><code>docker ps 
</code></pre>

<ul>
<li>CONTAINER ID 容器ID</li>
<li>IMAGE 镜像</li>
<li>COMMAND 初始命令</li>
<li>CREATED 创建日期</li>
<li>STATUS  容器状态</li>
<li>PORTS  端口号</li>
<li>NAMES 容器名字</li>
</ul>
<p>查看所有容器,包括已退出的容器</p>
<pre class="codehilite"><code>docker ps -a
</code></pre>

<p>查看最后一次运行的容器</p>
<pre class="codehilite"><code>docker ps -l
</code></pre>

<p>查看停止的容器</p>
<pre class="codehilite"><code>docker ps -f status=exited
</code></pre>

<h4>删除容器</h4>
<ul>
<li>删除指定容器</li>
</ul>
<pre class="codehilite"><code>docker  rm 容器名称|容器ID
</code></pre>

<ul>
<li>删除所有容器</li>
</ul>
<pre class="codehilite"><code>docker rm `docker ps -a -q`
</code></pre>

<ul>
<li>删除所有不在运行的容器</li>
</ul>
<pre class="codehilite"><code>docker rm `docker ps -a -q -f status=exited`
</code></pre>

<h4>进入容器</h4>
<p>进入启动的容器有好几种方式，下面介绍两种常见的方法</p>
<p>第一种：docker exec命令</p>
<pre class="codehilite"><code>docker exec -it 容器名称|容器ID /bin/bash
</code></pre>

<p>通过docker exec登录的容器的退出,输入"exit"退出不停止容器</p>
<p>第二种：nsenter命令</p>
<p>nsenter命令通过容器的pid进入容器。该命令不是系统自带的，需要安装，具体安装也很简单，直接yum安装即可</p>
<p>安装nsenter</p>
<pre class="codehilite"><code>yum install -y util-linux
</code></pre>

<p>进入容器</p>
<pre class="codehilite"><code class="language-bash">#查看容器pid
docker inspect -f &quot;{{.State.Pid}}&quot; mycentos
#进入容器,shell可以指定shell,不指定默认使用的是/bin/bash.
nsenter -t Pid -m -u -i -n -p /bin/sh
</code></pre>

<h4>查看容器内部细节</h4>
<p>查看容器的详细信息，可以通过docker inspect命令查看。不带参数则显示所有的信息</p>
<p>docker inspect 参数 容器名|容器ID</p>
<pre class="codehilite"><code class="language-bash">#查看容器IP地址
docker inspect --format='{{.NetworkSettings.IPAddress}}' mycentos
#查看容器Pid
docker inspect -f &quot;{{.State.Pid}}&quot; mycentos
</code></pre>
        </div>
        
    </div>



                


        </div>

    </div>
    <footer>
        
        <p>&copy; 2024 | 我的博客. 保留所有权利。</p>
    <!--    <p><a href="/privacy">隐私政策</a> | <a href="/terms">使用条款</a></p>-->
        
    </footer>

</body>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
 <!-- 在页面加载完成后启用代码高亮 -->
    <script>
        // 等待页面加载完成后执行高亮
        document.addEventListener('DOMContentLoaded', function() {
            // 启用 highlight.js 代码高亮
            hljs.highlightAll();
        });
    </script>


</html>