<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>linux下mongodb数据库安装配置使用</title>
    <link rel="icon" href="../static/img/favicon.png" type="image/png">
    <link rel="stylesheet" href="../static/css/styles.css"> <!-- 静态文件的链接 -->
    <!-- 引入 highlight.js 的 CSS 样式 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/atom-one-dark.min.css">

</head>
<body>
    <header>
        <div class="navbar container">
            <div class="menu">
                <div class="nav-title"><a href="/index.html">各自花开</a></div>
                <ul class="nav-menu">
                    
                        <li><a href="/index.html">首页</a></li>
                        <li><a href="/categories.html">分类</a>
                        <li><a href="/tags.html">标签</a>






                        <li><a href="webnav.html">网址导航</a></li>
                        <li><a href="https://www.baidu.com" target="_blank">资源分享
                        <!-- 外部链接图标 -->
                        <img src="../static/img/分享_share.png" alt="外部链接" style="position: absolute; top: 0; right: 0; width: 12px; height: 12px;transform: translateX(100%)">
                        </a></li>
                        <li><a href="/search.html">搜索</a></li>
                    
                </ul>
            </div>
        </div>
    </header>
    <div id="app" class="container">

            
            


        <div class="main container">
                
    <div class="content article-content">
        <h3>linux下mongodb数据库安装配置使用</h3>
        <div class="tag-container">
        








            
                <span>
                <img src="../static/img/标签_tag-one.png" class="img-icon">
                <a>linux</a>
            </span>
            
                <span>
                <img src="../static/img/标签_tag-one.png" class="img-icon">
                <a>mongodb</a>
            </span>
            

        </div>
        
        <div class="container article">
            <h1>mongodb的安装配置</h1>
<h2>解压安装文件到安装目录</h2>
<pre class="codehilite"><code class="language-bash">tar -C /usr/local mongodb-linux-x86_64-3.6.6.tgz 
mv /usr/local/mongodb-linux-x86_64-3.6.6 /usr/local/mongodb
mkdir -p /data/mongodb/db
mkdir -p /data/mongodb/logs
</code></pre>

<h2>添加配置文件</h2>
<!--more-->

<pre class="codehilite"><code class="language-bash">cat  &gt;&gt;/etc/mongodb.conf &lt;&lt; EOF
# mongod.conf
# for documentation of all options, see:
# http://docs.mongodb.org/manual/reference/configuration-options/
# where to write logging data.
systemLog:
  destination: file
  logAppend: true
  path: /data/mongodb/logs/mongod.log    #设置日志目录
# Where and how to store data.
storage:
  dbPath: /data/mongodb/db    #设置数据目录
  journal:
    enabled: true
#  engine:
#  mmapv1:
#  wiredTiger:
# how the process runs
processManagement:
  fork: true  # fork and run in background
  pidFilePath: /data/mongodb/logs/mongod.pid  # location of pidfile
  timeZoneInfo: /usr/share/zoneinfo
# network interfaces
net:
  port: 27017
  bindIp: 127.0.0.1  # Listen to local interface only, comment to listen on all interfaces.
security:
  authorization: enabled
#operationProfiling:
#replication:
#sharding:
## Enterprise-Only Options
#auditLog:
#snmp:
EOF
</code></pre>

<h2>启动mongo</h2>
<pre class="codehilite"><code class="language-bash">/usr/local/mongodb/bin/mongod  -f /etc/mongodb.conf
</code></pre>

<h2>登陆授权账户</h2>
<pre class="codehilite"><code class="language-bash">/usr/local/mongodb/bin/mongo
#创建管理用户
&gt;&gt;use admin
&gt;&gt;db.createUser(
&gt;&gt;    {
&gt;&gt;      user: &quot;admin&quot;,
&gt;&gt;      pwd: &quot;abcd1123&quot;,
&gt;&gt;      roles: \[ { role: &quot;root&quot;, db: &quot;admin&quot; } \]
&gt;&gt;    }
&gt;&gt;  )
</code></pre>

<h2>给非admin库授权</h2>
<p>一.管理员账户登陆</p>
<pre class="codehilite"><code class="language-bash">mongo mongodb://root@127.0.0.1:27017/admin
</code></pre>

<p>二.到需要授权的数据库下,使用use autest</p>
<pre class="codehilite"><code class="language-bash">use autest
db.createUser(
    {
      user: &quot;dbtest&quot;,
      pwd: &quot;4321dbtest&quot;,
      roles: \[ { role: &quot;dbOwner&quot;, db: &quot;autest&quot; } \]
    }
  )
</code></pre>

<p><strong>mongodb数据备份</strong></p>
<pre class="codehilite"><code class="language-bash">#!/bin/bash
datetime=\`date '+%Y%m%d'\`
echo $datetime
/usr/local/mongodb/bin/mongodump -o /data/mongoback/${datetime} 
cd /data/mongoback/
zip -9 -r -m ${datetime}.zip ${datetime}
</code></pre>

<h2>添加启动脚本</h2>
<p>Mongo安装完成后一般都是通过命令行或脚本形式启动，下面提供了设置为服务的脚本，具体如下</p>
<pre class="codehilite"><code class="language-bash">#!/bin/sh

### BEGIN INIT INFO
# Provides:     mongodb
# Required-Start:
# Required-Stop:
# Default-Start:        2 3 4 5
# Default-Stop:         0 1 6
# Short-Description: mongodb
# Description: mongo db server
### END INIT INFO

EXE_FILE=/usr/local/mongodb/bin/mongod
CONFIG_FILE=/etc/mongodb.conf

. /lib/lsb/init-functions
MONGOPID=\`ps -ef| grep mongod| grep -v grep| awk '{print $2}'\`
test -x $EXE_FILE || exit 0

case &quot;$1&quot; in
  start)
    ulimit -n 3000
    log\_begin\_msg &quot;Starting MongoDB server&quot;
    $EXE\_FILE --config $CONFIG\_FILE
    log\_end\_msg 0
    ;;
  stop)
    log\_begin\_msg &quot;Stopping MongoDB server&quot;
    if \[ ! -z &quot;$MONGOPID&quot; \]; then
        kill -15 $MONGOPID
    fi
    log\_end\_msg 0
    ;;
  status)
    ps -aux| grep mongod
    ;;
  *)
    log\_success\_msg &quot;Usage: /etc/init.d/mongodb {start|stop|status}&quot;
    exit 1
esac
</code></pre>

<h1>mongodb简单的CRUD操作</h1>
<h2>查看数据库</h2>
<pre class="codehilite"><code class="language-bash">show dbs#显示系统所以库
show collections#显示当前库的所有集合
</code></pre>

<p>mogno当中的集合也就是mysql当中的tables,数据保存在collections当中</p>
<h2>插入数据</h2>
<p>向user集合里面插入一条数据</p>
<pre class="codehilite"><code class="language-bash">db.users.insert({username:&quot;smith&quot;})
</code></pre>

<h2>修改数据</h2>
<pre class="codehilite"><code class="language-bash">db.users.update({username:&quot;smith&quot;},{$set:{country:&quot;China&quot;}})
</code></pre>

<h2>删除数据</h2>
<pre class="codehilite"><code class="language-bash">db.users.remove({username:&quot;China&quot;})
db.user.remove({})#干掉user集合内所有内容(清空集合)
db.user.drop()#干掉user集合(删除集合)
</code></pre>

<h2>查找数据</h2>
<pre class="codehilite"><code class="language-bash">db.users.count()#查看集合内有多少条数据
db.users.find()
db.users.find({username:&quot;smith&quot;})
</code></pre>
        </div>
        
    </div>



                


        </div>

    </div>
    <footer>
        
        <p>&copy; 2024 | 我的博客. 保留所有权利。</p>
    <!--    <p><a href="/privacy">隐私政策</a> | <a href="/terms">使用条款</a></p>-->
        
    </footer>

</body>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
 <!-- 在页面加载完成后启用代码高亮 -->
    <script>
        // 等待页面加载完成后执行高亮
        document.addEventListener('DOMContentLoaded', function() {
            // 启用 highlight.js 代码高亮
            hljs.highlightAll();
        });
    </script>


</html>