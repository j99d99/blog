<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>linux下安装配置nfs</title>
    <link rel="icon" href="../static/img/favicon.png" type="image/png">
    <link rel="stylesheet" href="static/css/styles.css"> <!-- 静态文件的链接 -->
    <!-- 引入 highlight.js 的 CSS 样式 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/atom-one-dark.min.css">

</head>
<body>
    <header>
        <div class="navbar container">
            <div class="menu">
                <div class="nav-title"><a href="/index.html">各自花开</a></div>
                <ul class="nav-menu">
                    
                        <li><a href="/index.html">首页</a></li>
                        <li><a href="/categories.html">分类</a>
                        <li><a href="/tags.html">标签</a>






                        <li><a href="webnav.html">网址导航</a></li>
                        <li><a href="https://www.baidu.com" target="_blank">资源分享
                        <!-- 外部链接图标 -->
                        <img src="../static/img/分享_share.png" alt="外部链接" style="position: absolute; top: 0; right: 0; width: 12px; height: 12px;transform: translateX(100%)">
                        </a></li>
                        <li><a href="/search.html">搜索</a></li>
                    
                </ul>
            </div>
        </div>
    </header>
    <div id="app" class="container">

            
            


        <div class="main container">
                
    <div class="content article-content">
        <h3>linux下安装配置nfs</h3>
        <div class="tag-container">
        








            
                <span>
                <img src="../static/img/标签_tag-one.png" class="img-icon">
                <a>linux</a>
            </span>
            

        </div>
        
        <div class="container article">
            <p>在我们使学习用k8s过程当中，pod容器中数据的持久化存储是经常被使用到的，也是需要掌握的。这里我们提供一种简单常用的持久化存储方案nfs，以方便我们学习。只有我们掌握了k8s的持久化存储，才能在生产环境更换更优的选择合适放持久化存储方案</p>
<p>本文介绍centos7系统上搭建nfs系统。</p>
<!--more-->
<h5>nfs server端安装</h5>
<p>nfs的安装很简单，直接yum安装即可，执行下面的安装命令</p>
<pre class="codehilite"><code class="language-bash">yum install -y nfs-utils
</code></pre>

<p>简单的一条命令。很快我们就完成了nfs的安装。下面我们来配置nfs系统。nfs的配置文件为/etc/exports.</p>
<pre class="codehilite"><code class="language-bash">vim /etc/exports
#格式: 共享目录 客户端(权限设置,映射关系、其他) 客户端和选项之间没有空格
/data/pv1 *(rw,no_root_squash,sync)

#创建共享目录
mkdir /data/pv1
</code></pre>

<p>启动nfs server并查看配置是否生效</p>
<pre class="codehilite"><code class="language-bash">systemctl enable rpcbind
systemctl enable nfs-server

systemctl start rpcbind
systemctl start nfs-server
exportfs -r
</code></pre>

<h5>客户端配置并使用</h5>
<p>同样执行安装命令</p>
<pre class="codehilite"><code class="language-bash">yum install -y nfs-utils
</code></pre>

<p>查看nfs 服务器设置共享目录</p>
<pre class="codehilite"><code class="language-bash">showmount -e 172.16.88.209      #此ip为nfs-server的服务器IP
#返回结果
Export list for 172.16.88.209:
/data/pv1 *
</code></pre>

<p>执行命令进行目录挂载</p>
<pre class="codehilite"><code class="language-bash">#创建数据挂载目录
mkdir /data
# mount -t nfs $(nfs服务器的IP):/data/pv1 /data
mount -t nfs 172.16.88.209:/data/pv1 /data
</code></pre>

<h5>nfs配置项注解</h5>
<ul>
<li>共享目录</li>
<li>nfs共享给客户端使用的目录</li>
<li>客户端</li>
<li>指定主机IP：172.16.0.1</li>
<li>指定子网所有主机：172.16.0.0/24</li>
<li>指定域名： nfs.test.com、*.test.com</li>
<li>所有主机：*</li>
<li>权限设置</li>
<li>只读权限：ro</li>
<li>读写权限：rw</li>
<li>属组映射</li>
<li>all_squash：将远程访问的所有普通用户及所属组都映射为匿名用户或用户组（nfsnobody）；</li>
<li>no_all_squash：与all_squash取反（默认设置）；</li>
<li>root_squash：将root用户及所属组都映射为匿名用户或用户组（默认设置）；</li>
<li>no_root_squash：与rootsquash取反；</li>
<li>anonuid=xxx：将远程访问的所有用户都映射为匿名用户，并指定该用户为本地用户（UID=xxx）；</li>
<li>anongid=xxx：将远程访问的所有用户组都映射为匿名用户组账户，并指定该匿名用户组账户为本地用户组账户（GID=xxx）；</li>
<li>其他选项</li>
<li>secure：限制客户端只能从小于1024的tcp/ip端口连接nfs服务器（默认设置）；</li>
<li>insecure：允许客户端从大于1024的tcp/ip端口连接服务器；</li>
<li>sync：将数据同步写入内存缓冲区与磁盘中，效率低，但可以保证数据的一致性；</li>
<li>async：将数据先保存在内存缓冲区中，必要时才写入磁盘；</li>
<li>wdelay：检查是否有相关的写操作，如果有则将这些写操作一起执行，这样可以提高效率（默认设置）；</li>
<li>no_wdelay：若有写操作则立即执行，应与sync配合使用；</li>
<li>subtree：若输出目录是一个子目录，则nfs服务器将检查其父目录的权限(默认设置)；</li>
<li>no_subtree：即使输出目录是一个子目录，nfs服务器也不检查其父目录的权限，这样可以提高效率；</li>
</ul>
        </div>
        
    </div>



                


        </div>

    </div>
    <footer>
        
        <p>&copy; 2024 | 我的博客. 保留所有权利。</p>
    <!--    <p><a href="/privacy">隐私政策</a> | <a href="/terms">使用条款</a></p>-->
        
    </footer>

</body>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
 <!-- 在页面加载完成后启用代码高亮 -->
    <script>
        // 等待页面加载完成后执行高亮
        document.addEventListener('DOMContentLoaded', function() {
            // 启用 highlight.js 代码高亮
            hljs.highlightAll();
        });
    </script>


</html>