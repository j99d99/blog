<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>python的paramiko模块的使用</title>
    <link rel="icon" href="../static/img/favicon.png" type="image/png">
    <link rel="stylesheet" href="../static/css/styles.css"> <!-- 静态文件的链接 -->
    <!-- 引入 highlight.js 的 CSS 样式 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/atom-one-dark.min.css">

</head>
<body>
    <header>
        <div class="navbar container">
            <div class="menu">
                <div class="nav-title"><a href="/index.html">各自花开</a></div>
                <ul class="nav-menu">
                    
                        <li><a href="/index.html">首页</a></li>
                        <li><a href="/categories.html">分类</a>
                        <li><a href="/tags.html">标签</a>






                        <li><a href="webnav.html">网址导航</a></li>
                        <li><a href="https://www.baidu.com" target="_blank">资源分享
                        <!-- 外部链接图标 -->
                        <img src="../static/img/分享_share.png" alt="外部链接" style="position: absolute; top: 0; right: 0; width: 12px; height: 12px;transform: translateX(100%)">
                        </a></li>
                        <li><a href="/search.html">搜索</a></li>
                    
                </ul>
            </div>
        </div>
    </header>
    <div id="app" class="container">

            
            


        <div class="main container">
                
    <div class="content article-content">
        <h3>python的paramiko模块的使用</h3>
        <div class="tag-container">
        








            
                <span>
                <img src="../static/img/标签_tag-one.png" class="img-icon">
                <a>linux</a>
            </span>
            
                <span>
                <img src="../static/img/标签_tag-one.png" class="img-icon">
                <a>python</a>
            </span>
            

        </div>
        
        <div class="container article">
            <p>Paramiko 是一个用 Python 语言编写的 SSHv2 协议客户端，它提供了基于 SSH 协议进行远程服务器连接和文件传输的功能。下面是 Paramiko 的一些详细使用方法：</p>
<h2>安装</h2>
<p>使用 pip 工具进行安装：</p>
<pre class="codehilite"><code>pip install paramiko
</code></pre>

<h2>基本用法</h2>
<h3>连接远程服务器</h3>
<pre class="codehilite"><code class="language-python">import paramiko

ssh = paramiko.SSHClient()
ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())  # 允许自动添加新主机到本地 ~/.ssh/known_hosts 文件中

ssh.connect(hostname='server_ip', port=22, username='username', password='password')

stdin, stdout, stderr = ssh.exec_command('ls -l')
print(stdout.read().decode())

ssh.close()
</code></pre>

<h3>使用密钥文件连接远程服务器</h3>
<pre class="codehilite"><code class="language-python">import paramiko

ssh = paramiko.SSHClient()
ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())  # 允许自动添加新主机到本地 ~/.ssh/known_hosts 文件中

key = paramiko.RSAKey.from_private_key_file('/path/to/key.pem')
ssh.connect(hostname='server_ip', port=22, username='username', pkey=key)

stdin, stdout, stderr = ssh.exec_command('ls -l')
print(stdout.read().decode())

ssh.close()
</code></pre>

<h3>上传文件到远程服务器</h3>
<pre class="codehilite"><code class="language-python">import paramiko

ssh = paramiko.SSHClient()
ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())  # 允许自动添加新主机到本地 ~/.ssh/known_hosts 文件中

ssh.connect(hostname='server_ip', port=22, username='username', password='password')

sftp = ssh.open_sftp()
sftp.put('/path/to/local/file.txt', '/path/to/remote/file.txt')

sftp.close()
ssh.close()
</code></pre>

<h3>从远程服务器下载文件</h3>
<pre class="codehilite"><code class="language-python">import paramiko

ssh = paramiko.SSHClient()
ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())  # 允许自动添加新主机到本地 ~/.ssh/known_hosts 文件中

ssh.connect(hostname='server_ip', port=22, username='username', password='password')

sftp = ssh.open_sftp()
sftp.get('/path/to/remote/file.txt', '/path/to/local/file.txt')

sftp.close()
ssh.close()
</code></pre>

<h2>进阶用法</h2>
<h3>通过 SSH 隧道连接数据库</h3>
<p>```python
import paramiko
import pymysql</p>
<p>ssh = paramiko.SSHClient()
ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())  # 允许自动添加新主机到本地 ~/.ssh/known_hosts 文件中</p>
<p>ssh.connect(hostname='ssh_server_ip', port=22, username='ssh_username', password='ssh_password')</p>
<h1>建立 SSH 隧道连接数据库</h1>
<p>transport = ssh.get_transport()
local_port = 3306
remote_addr = ('db_server_ip', 3306)
destination_addr = ('localhost', local_port)
transport.request_port_forward(*destination_addr, remote_addr)</p>
<h1>连接本地 MySQL 数据库</h1>
<p>conn = pymysql.connect(host='localhost', port=local_port, user='mysql_username', password='mysql_password', database='mysql_db')</p>
<h1>执行 SQL 查询</h1>
<p>cur = conn.cursor()
cur.execute('SELECT * FROM mysql.user')
result = cur.fetchall()
print(result)</p>
<p>cur.close()
conn</p>
        </div>
        
    </div>



                


        </div>

    </div>
    <footer>
        
        <p>&copy; 2024 | 我的博客. 保留所有权利。</p>
    <!--    <p><a href="/privacy">隐私政策</a> | <a href="/terms">使用条款</a></p>-->
        
    </footer>

</body>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
 <!-- 在页面加载完成后启用代码高亮 -->
    <script>
        // 等待页面加载完成后执行高亮
        document.addEventListener('DOMContentLoaded', function() {
            // 启用 highlight.js 代码高亮
            hljs.highlightAll();
        });
    </script>


</html>