<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>搭建内网dns服务</title>
    <link rel="icon" href="../static/img/favicon.png" type="image/png">
    <link rel="stylesheet" href="../static/css/styles.css"> <!-- 静态文件的链接 -->
    <!-- 引入 highlight.js 的 CSS 样式 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/atom-one-dark.min.css">

</head>
<body>
    <header>
        <div class="navbar container">
            <div class="menu">
                <div class="nav-title"><a href="/index.html">各自花开</a></div>
                <ul class="nav-menu">
                    
                        <li><a href="/index.html">首页</a></li>
                        <li><a href="/categories.html">分类</a>
                        <li><a href="/tags.html">标签</a>






                        <li><a href="webnav.html">网址导航</a></li>
                        <li><a href="https://www.baidu.com" target="_blank">资源分享
                        <!-- 外部链接图标 -->
                        <img src="../static/img/分享_share.png" alt="外部链接" style="position: absolute; top: 0; right: 0; width: 12px; height: 12px;transform: translateX(100%)">
                        </a></li>
                        <li><a href="/search.html">搜索</a></li>
                    
                </ul>
            </div>
        </div>
    </header>
    <div id="app" class="container">

            
            


        <div class="main container">
                
    <div class="content article-content">
        <h3>搭建内网dns服务</h3>
        <div class="tag-container">
        








            
                <span>
                <img src="../static/img/标签_tag-one.png" class="img-icon">
                <a>linux</a>
            </span>
            

        </div>
        
        <div class="container article">
            <h4>安装</h4>
<pre class="codehilite"><code class="language-bash">#安装
yum install -y bind
firewall-cmd --permanent --add-service=dns
firewall-cmd --reload
# 开机自启
systemctl enable named
# 启动
systemctl start named
</code></pre>

<h4>配置</h4>
<ol>
<li>/etc/named.conf</li>
</ol>
<pre class="codehilite"><code class="language-bash">options {
        # any表示本地所有网络接口上开启53端口
        listen-on port 53 { any; };
        listen-on-v6 port 53 { ::1; };
        directory       &quot;/var/named&quot;;
        dump-file       &quot;/var/named/data/cache_dump.db&quot;;
        statistics-file &quot;/var/named/data/named_stats.txt&quot;;
        memstatistics-file &quot;/var/named/data/named_mem_stats.txt&quot;;
        recursing-file  &quot;/var/named/data/named.recursing&quot;;
        secroots-file   &quot;/var/named/data/named.secroots&quot;;
        # 允许查询A记录的客户端列表，any表示所有
        allow-query     { any; };
        # 设置上级提供查询解析地址的dns
        forwarders      { 114.114.114.114; };

        recursion yes;

        dnssec-enable yes;
        # 关闭dns检测，使dns能够缓存外部信息到本机
        dnssec-validation no;

        /* Path to ISC DLV key */
        bindkeys-file &quot;/etc/named.root.key&quot;;

        managed-keys-directory &quot;/var/named/dynamic&quot;;

        pid-file &quot;/run/named/named.pid&quot;;
        session-keyfile &quot;/run/named/session.key&quot;;
};

logging {
        channel default_debug {
                file &quot;data/named.run&quot;;
                severity dynamic;
        };
};

zone &quot;.&quot; IN {
        type hint;
        file &quot;named.ca&quot;;
};

include &quot;/etc/named.rfc1912.zones&quot;;
include &quot;/etc/named.root.key&quot;;
</code></pre>

<ol>
<li>/etc/named.rfc1912.zones</li>
</ol>
<p>创建内网需要解析的域名</p>
<pre class="codehilite"><code class="language-bash"># 添加该段内容
zone &quot;hehu.com&quot; IN {
        # dns为master，即主dns
        type master;
        # hehu.com域名的解析文件
        file &quot;hehu.com.zone&quot;;
        allow-update { none; };
};

zone &quot;localhost.localdomain&quot; IN {
        type master;
        file &quot;named.localhost&quot;;
        allow-update { none; };
};

zone &quot;localhost&quot; IN {
        type master;
        file &quot;named.localhost&quot;;
        allow-update { none; };
};

zone &quot;1.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.ip6.arpa&quot; IN {
        type master;
        file &quot;named.loopback&quot;;
        allow-update { none; };
};

zone &quot;1.0.0.127.in-addr.arpa&quot; IN {
        type master;
        file &quot;named.loopback&quot;;
        allow-update { none; };
};

zone &quot;0.in-addr.arpa&quot; IN {
        type master;
        file &quot;named.empty&quot;;
        allow-update { none; };
};
</code></pre>

<ol>
<li>/var/named/hehu.com.zone</li>
</ol>
<pre class="codehilite"><code class="language-bash">cd /var/named
cp named.localhost hehu.com.zone
</code></pre>
        </div>
        
    </div>



                


        </div>

    </div>
    <footer>
        
        <p>&copy; 2024 | 我的博客. 保留所有权利。</p>
    <!--    <p><a href="/privacy">隐私政策</a> | <a href="/terms">使用条款</a></p>-->
        
    </footer>

</body>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
 <!-- 在页面加载完成后启用代码高亮 -->
    <script>
        // 等待页面加载完成后执行高亮
        document.addEventListener('DOMContentLoaded', function() {
            // 启用 highlight.js 代码高亮
            hljs.highlightAll();
        });
    </script>


</html>