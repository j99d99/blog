<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>进程管理利器-supervisor的安装配置使用</title>
    <link rel="icon" href="../static/img/favicon.png" type="image/png">
    <link rel="stylesheet" href="static/css/styles.css"> <!-- 静态文件的链接 -->
    <!-- 引入 highlight.js 的 CSS 样式 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/atom-one-dark.min.css">

</head>
<body>
    <header>
        <div class="navbar container">
            <div class="menu">
                <div class="nav-title"><a href="/index.html">各自花开</a></div>
                <ul class="nav-menu">
                    
                        <li><a href="/index.html">首页</a></li>
                        <li><a href="/categories.html">分类</a>
                        <li><a href="/tags.html">标签</a>






                        <li><a href="webnav.html">网址导航</a></li>
                        <li><a href="https://www.baidu.com" target="_blank">资源分享
                        <!-- 外部链接图标 -->
                        <img src="../static/img/分享_share.png" alt="外部链接" style="position: absolute; top: 0; right: 0; width: 12px; height: 12px;transform: translateX(100%)">
                        </a></li>
                        <li><a href="/search.html">搜索</a></li>
                    
                </ul>
            </div>
        </div>
    </header>
    <div id="app" class="container">

            
            


        <div class="main container">
                
    <div class="content article-content">
        <h3>进程管理利器-supervisor的安装配置使用</h3>
        <div class="tag-container">
        








            
                <span>
                <img src="../static/img/标签_tag-one.png" class="img-icon">
                <a>linux</a>
            </span>
            

        </div>
        
        <div class="container article">
            <p>今天介绍一个进程管理工具supervisor，Supervisor是用Python开发的一套通用的进程管理程序，能将一个普通的命令行进程变为后台daemon，并监控进程状态，异常退出时能自动重启。它是通过fork/exec的方式把这些被管理的进程当作supervisor的子进程来启动，这样只要在supervisor的配置文件中，把要管理的进程的可执行文件的路径写进去即可。也实现当子进程挂掉的时候，父进程可以准确获取子进程挂掉的信息的，可以选择是否自己启动和报警。supervisor还提供了一个功能，可以为supervisord或者每个子进程，设置一个非root的user，这个user就可以管理它对应的进程。
 <!--more-->
</p>
<h2>安装</h2>
<p>supervisor的安装很简单</p>
<pre class="codehilite"><code class="language-bash">easy_install supervisor
</code></pre>

<h2>配置</h2>
<ul>
<li>1.生成初始配置文件</li>
</ul>
<pre class="codehilite"><code class="language-bash">echo_supervisord_conf &gt; /etc/supervisord.conf
vim /etc/supervisord.conf
#配置文件最后一行进行修改
[include]
;files = relative/directory/*.ini
files = /etc/supervisord.d/*.conf
</code></pre>

<ul>
<li>2.配置应用启动文件</li>
</ul>
<p>这里以创建某个程序启动服务为样例
<strong>举例</strong></p>
<pre class="codehilite"><code class="language-bash">mkdir -p /etc/supervisord.d/
cd /etc/supervisord.d/
vim suptest.conf
#配置段内容如下
[program:suptest]    #定义program，启动时使用,比如&quot;supervisorctl start suptest&quot;
user=root
command= java -jar test.jar     #应用启动命令,具体实际为准
autostart=true        #伴随服务自动启动
autorestart=true    #伴随服务自动重启
startsecs=10
stdout_logfile=/data/logs/suptest.log    #定义日志输出路径,需确保目录存在
stdout_logfile_maxbytes=1MB
stdout_logfile_backups=10
stdout_capture_maxbytes=1MB
stderr_logfile=/data/logs/suptest_err.log    #定义错误日志输出路径,需确保目录存在
stderr_logfile_maxbytes=1MB
stderr_logfile_backups=10
stderr_capture_maxbytes=1MB
stopsignal=INT
[supervisord]    #配置结束标志
</code></pre>

<ul>
<li>3.启动supervisor服务</li>
</ul>
<pre class="codehilite"><code class="language-bash">/usr/local/bin/supervisord -c /etc/supervisord.conf    #启动服务
</code></pre>

<ul>
<li>4.suptest服务的启动关闭重启操作</li>
</ul>
<pre class="codehilite"><code class="language-bash">supervisorctl start suptest
supervisorctl stop suptest
supervisorctl restart suptest
supervisorctl status 
supervisorctl start all    #所有进程的操作
</code></pre>

<ul>
<li>5.supervisor的web管理界面配置</li>
</ul>
<pre class="codehilite"><code class="language-bash">vim /etc/supervisord.conf
#配置文件最后一行进行修改
[inet_http_server]
port=0.0.0.0:8080
username=supervisor
password=supervisor
</code></pre>

<p>重启服务，可通过web访问控制</p>
        </div>
        
    </div>



                


        </div>

    </div>
    <footer>
        
        <p>&copy; 2024 | 我的博客. 保留所有权利。</p>
    <!--    <p><a href="/privacy">隐私政策</a> | <a href="/terms">使用条款</a></p>-->
        
    </footer>

</body>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
 <!-- 在页面加载完成后启用代码高亮 -->
    <script>
        // 等待页面加载完成后执行高亮
        document.addEventListener('DOMContentLoaded', function() {
            // 启用 highlight.js 代码高亮
            hljs.highlightAll();
        });
    </script>


</html>